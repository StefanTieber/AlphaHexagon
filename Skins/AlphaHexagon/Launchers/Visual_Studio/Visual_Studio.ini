[Metadata]
Name=Visual_Studio
Author=Lycodo
Information=Visual Studio Launcher

[Variables]
GrayIcon=Visual_Studio_g.png
ColorIcon=Visual_Studio.png
Launch=["%PROGRAMFILES(X86)%\Microsoft Visual Studio\2017\Community\Common7\IDE\devenv.exe"]

@Include="#@#variables.inc"
U=[!UpdateMeasure "Fader"][!UpdateMeter "MeterColorIcon"][!Redraw]
Alpha=0

[Rainmeter]
Update=-1
MiddleMouseUpAction=[!Refresh #CURRENTCONFIG#]
OnRefreshAction=[!Move [GridPositionX] [GridPositionY]][!Zpos -2]

[GridPositionX]
Measure=Calc
Formula=Round((#CURRENTCONFIGX# - #GridX#) / #GridW#) * #GridW# + #GridX#
[GridPositionY]
Measure=Calc
Formula=Round((#CURRENTCONFIGY# - #GridY#) / #GridH#) * #GridH# + #GridY#

[Fader]
Measure=Plugin
Plugin=ActionTimer
FadeIn=[!SetVariable Alpha "(Clamp((#Alpha#+#FadeInStep#),0,255))"]#U#
FadeOut=[!SetVariable Alpha "(Clamp((#Alpha#-#FadeOutStep#),0,255))"]#U#
Hide=[!HideMeter "MeterGrayIcon"][!UpdateMeter "MeterGrayIcon"][!Redraw]
Show=[!ShowMeter "MeterGrayIcon"][!UpdateMeter "MeterGrayIcon"][!Redraw]
ActionList1=Repeat FadeIn,1,#FadeInRepeat# | Hide
ActionList2=Show | Repeat FadeOut,1,#FadeOutRepeat#
DynamicVariables=1

[MeterHitbox]
Meter=Image
ImageName=#IconDir##Hitbox#
W=#IconWith#
ImageAlpha=#HitboxAlpha#
AntiAlias=1
LeftMouseUpAction=#Launch#
MouseOverAction=[!CommandMeasure Fader "Stop 2"][!CommandMeasure Fader "Execute 1"]
MouseLeaveAction=[!CommandMeasure Fader "Stop 1"][!CommandMeasure Fader "Execute 2"]

[MeterGrayIcon]
Meter=Image
ImageName=#IconDir##GrayIcon#
W=#IconWith#
AntiAlias=1

[MeterColorIcon]
Meter=Image
ImageName=#IconDir##ColorIcon#
W=#IconWith#
ImageAlpha=#Alpha#
AntiAlias=1
DynamicVariables=1
