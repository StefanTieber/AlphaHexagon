[Metadata]
Name=Power_Button
Author=Lycodo
Information=Power Button to turn off the screen with menu to lock/shutdown/restart

[Variables]
GrayIcon=Power_Button_g.png
ColorIcon=Power_Button.png
Launch=[!CommandMeasure MeasureMonitorOff "Run"]

MenuConfig=#CURRENTCONFIG#\Power_Menu
MenuFile=Power_Menu.ini

@Include="#@#variables.inc"
@Include2="#@#measures.inc"
U=[!UpdateMeasure "Fader"][!UpdateMeter "MeterColorIcon"][!Redraw]
Alpha=0

[Rainmeter]
Update=-1
MiddleMouseUpAction=[!Refresh #CURRENTCONFIG#]
OnRefreshAction=[!Move [GridPositionX] [GridPositionY]][!Zpos -2][!ActivateConfig #MenuConfig# #MenuFile#]
OnCloseAction=[!DeactivateConfig #MenuConfig# #MenuFile#]
OnUnfocusAction=[!Hide #MenuConfig#]

[GridPositionX]
Measure=Calc
Formula=Round((#CURRENTCONFIGX# - #GridX#) / #GridW#) * #GridW# + #GridX#
[GridPositionY]
Measure=Calc
Formula=Round((#CURRENTCONFIGY# - #GridY#) / #GridH#) * #GridH# + #GridY#

[MeasureMonitorOff]
Measure=Plugin
Plugin=RunCommand
Parameter="MonitorOff.exe"
State=Hide

[Fader]
Measure=Plugin
Plugin=ActionTimer
FadeIn=[!SetVariable Alpha "(Clamp((#Alpha#+#FadeInStep#),0,255))"]#U#
FadeOut=[!SetVariable Alpha "(Clamp((#Alpha#-#FadeOutStep#),0,255))"]#U#
Hide=[!HideMeter "MeterGrayIcon"][!UpdateMeter "MeterGrayIcon"][!Redraw]
Show=[!ShowMeter "MeterGrayIcon"][!UpdateMeter "MeterGrayIcon"][!Redraw]
ActionList1=Repeat FadeIn,1,#FadeInRepeat# | Hide
ActionList2=Show | Repeat FadeOut,1,#FadeOutRepeat#
DynamicVariables=1

[MeterHitbox]
Meter=Image
ImageName=#IconDir##HitboxLight#
W=#IconWith#
ImageAlpha=#HitboxAlpha#
AntiAlias=1
MouseOverAction=[!CommandMeasure Fader "Stop 2"][!CommandMeasure Fader "Execute 1"]
MouseLeaveAction=[!CommandMeasure Fader "Stop 1"][!CommandMeasure Fader "Execute 2"]
LeftMouseUpAction=#Launch#
RightMouseUpAction=[!UpdateMeasureGroup MouseMeasure][!Move [MouseX] ([MouseY]-(3*22+10)) #MenuConfig#][!Show #MenuConfig#]

[MeterGrayIcon]
Meter=Image
ImageName=#IconDir##GrayIcon#
W=#IconWith#
AntiAlias=1

[MeterColorIcon]
Meter=Image
ImageName=#IconDir##ColorIcon#
W=#IconWith#
ImageAlpha=#Alpha#
AntiAlias=1
DynamicVariables=1
